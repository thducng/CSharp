
\newcommand{\headrulecolor}[1]{\patchcmd{\headrule}{\hrule}{\color{#1}\hrule}{}{}}

\newcommand{\fancyfootnotetext}[2]{
\parbox{12cm}{\footnotemark[#1]\footnotesize #2}}

\fancypagestyle{plain}{%
\fancyhead{}
\renewcommand{\headrulewidth}{0pt}
\fancyfoot{} 
\fancyfoot[RE,LO]{Page \thepage{} of \pageref{LastPage}}
}


% fancy header and fooder start
\fancyhead{} 
\fancyhead[RO,RE]{\nouppercase{\rightmark}}
\fancyhead[LO,LE]{\today}
\fancyfoot{} 
\fancyfoot[RE,LO]{Page \thepage{} of \pageref{LastPage}}
\headrulecolor{gray!50}
\renewcommand{\headrulewidth}{0.1pt}
\pagestyle{fancy}
% fancy header and fooder end

